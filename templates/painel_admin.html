<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Clientes</title>
    <link href="https://cdn.jsdelivr.net/npm/tailwindcss@2.2.19/dist/tailwind.min.css" rel="stylesheet">
    <script src="https://cdn.jsdelivr.net/npm/alpinejs@2.8.2/dist/alpine.min.js" defer></script>
    <script src="https://code.jquery.com/jquery-3.6.4.min.js"></script>
    <link rel="stylesheet" href="../static/styles/components/sidebar.css">
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.8.0/font/bootstrap-icons.css" />
</head>

<body class="font-sans antialiased bg-gray-100 dark:bg-gray-800">

    <div id="content" class="flex justify-center items-center min-h-screen transition-margin">
        <nav
            class="bg-white dark:bg-gray-900 fixed w-full z-20 top-0 left-0 border-b border-gray-200 dark:border-gray-600">
            <div class="max-w-screen-xl flex flex-wrap items-center justify-between mx-auto p-4">
                <a href="https://flowbite.com/" class="flex items-center">
                    <img src="https://flowbite.com/docs/images/logo.svg" class="h-8 mr-3" alt="Flowbite Logo">
                    <span class="self-center text-2xl font-semibold whitespace-nowrap dark:text-white">Flowbite</span>
                </a>
                <div class="flex md:order-2">
                    <button data-collapse-toggle="navbar-sticky" type="button"
                        class="inline-flex items-center p-2 w-10 h-10 justify-center text-sm text-gray-500 rounded-lg md:hidden hover:bg-gray-100 focus:outline-none focus:ring-2 focus:ring-gray-200 dark:text-gray-400 dark:hover:bg-gray-700 dark:focus:ring-gray-600"
                        aria-controls="navbar-sticky" aria-expanded="false">
                        <span class="sr-only">Open main menu</span>
                        <svg class="w-5 h-5" aria-hidden="true" xmlns="http://www.w3.org/2000/svg" fill="none"
                            viewBox="0 0 17 14">
                            <path stroke="currentColor" stroke-linecap="round" stroke-linejoin="round" stroke-width="2"
                                d="M1 1h15M1 7h15M1 13h15" />
                        </svg>
                    </button>
                    <div id="openSidebarButton" class="absolute text-white text-4xl top-3 left-4 cursor-pointer">
                        <i class="bi bi-list px-2 bg-gray-900 rounded-md"></i>
                    </div>
                </div>
        </nav>


        

        <div id="sidebar" onclick="event.stopPropagation();"
            class="sidebar fixed top-0 bottom-0 lg:left-0 p-2 w-[300px] overflow-y-auto text-center bg-gray-900">

            <div class="text-gray-100 text-xl">
                <div class="p-2.5 mt-1 flex items-center">
                    <i class="bi bi-app-indicator px-2 py-1 rounded-md bg-blue-600"></i>
                    <h1 class="font-bold text-gray-200 text-[15px] ml-3">Sistema</h1>

                    <div class="my-2 bg-gray-600 h-[1px]"></div>
                </div>
                <button class="close-button ml-28 " onclick="toggleSidebar()">
                    &times;
                </button>

            </div>
            <div class="p-2.5 flex items-center rounded-md px-4 duration-300 cursor-pointer bg-gray-700 text-white">
                <i class="bi bi-search text-sm"></i>
                <input id="searchInput" type="text" placeholder="Search"
                    class="text-[15px] ml-4 w-full bg-transparent focus:outline-none" />
            </div>
            <div id="optionsContainer">
                <a href="{{ url_for('main_routes.painel_admin') }}">
                    <div
                        class="p-2.5 mt-3 flex items-center rounded-md px-4 duration-300 cursor-pointer hover:bg-blue-600 text-white">
                        <i class="bi bi-house-door-fill"></i>

                        <span class="text-[15px] ml-4 text-gray-200 font-bold">Home</span>

                    </div>
                </a>
                <div class="my-4 bg-gray-600 h-[1px]"></div>
                <div class="p-2.5 mt-3 flex items-center rounded-md px-4 duration-300 cursor-pointer hover:bg-blue-600 text-white"
                    onclick="dropdown_usuarios()">
                    <i class="bi bi-people"></i>
                    <div class="flex justify-between w-full items-center">
                        <span class="text-[15px] ml-4 text-gray-200 font-bold">Usuários</span>
                        <span class="text-sm rotate-180" id="arrow_usuarios">
                            <i class="bi bi-chevron-down"></i>
                        </span>
                    </div>
                </div>

                <div class="text-left text-sm mt-2 w-4/5 mx-auto text-gray-200 font-bold" id="submenu_usuarios">
                    <a href="{{ url_for('main_routes.adicionar_usuario') }}">
                        <h1 class="cursor-pointer p-2 hover:bg-blue-600 rounded-md mt-1">
                            Cadastrar Usuário
                        </h1>
                    </a>
                    <a href="{{ url_for('main_routes.painel_admin') }}">
                        <h1 class="cursor-pointer p-2 hover:bg-blue-600 rounded-md mt-1">
                            Usuários Cadastrados
                        </h1>
                    </a>
                </div>
                <div class="my-4 bg-gray-600 h-[1px]"></div>
                <div class="p-2.5 mt-3 flex items-center rounded-md px-4 duration-300 cursor-pointer hover:bg-blue-600 text-white"
                    onclick="dropdown_empresas()">
                    <i class="bi bi-building"></i>
                    <div class="flex justify-between w-full items-center">
                        <span class="text-[15px] ml-4 text-gray-200 font-bold">Empresas</span>
                        <span class="text-sm rotate-180" id="arrow_empresas">
                            <i class="bi bi-chevron-down"></i>
                        </span>
                    </div>
                </div>
                <div class="text-left text-sm mt-2 w-4/5 mx-auto text-gray-200 font-bold" id="submenu_empresas">
                    <a href="{{ url_for('main_routes.cadastrar_empresa') }}">
                        <h1 class="cursor-pointer p-2 hover:bg-blue-600 rounded-md mt-1">
                            Cadastrar Empresa
                        </h1>
                    </a>
                    <a href="{{ url_for('main_routes.visualizar_empresas') }}">
                        <h1 class="cursor-pointer p-2 hover:bg-blue-600 rounded-md mt-1">
                            Empresas Cadastradas
                        </h1>
                    </a>
                </div>

                <div
                    class="p-2.5 mt-3 flex items-center rounded-md px-4 duration-300 cursor-pointer hover:bg-blue-600 text-white">
                    <i class="bi bi-box-arrow-in-right"></i>
                    <span class="text-[15px] ml-4 text-gray-200 font-bold">Logout</span>
                </div>
            </div>
        </div>
    </div>



    <div>

        <!-- Exibir mensagens de erro ou sucesso -->
        {% with messages = get_flashed_messages() %}
        {% if messages %}
        <ul class="messages">
            {% for message, category in messages %}
            <li class="message {{ category }}">{{ message }}</li>
            {% endfor %}
        </ul>
        {% endif %}
        {% endwith %}

        <div class="flex justify-between items-center mt-4 mx-4">
            <a href="{{ url_for('main_routes.adicionar_usuario') }}"
                class="text-white bg-blue-700 hover:bg-blue-800 focus:ring-4 focus:ring-blue-300 font-medium rounded-lg text-sm px-5 py-2.5 dark:bg-blue-600 dark:hover:bg-blue-700 focus:outline-none dark:focus:ring-blue-800">Adicionar
                Usuário</a>

            <div class="flex items-center">
                <input id="filterInput" type="text" placeholder="Filtrar por nome"
                    class="px-4 py-2 rounded-md border border-gray-300 focus:outline-none focus:border-blue-500">
                <input id="filterInputCpf" type="text" placeholder="Filtrar por CPF"    class="px-4 py-2 rounded-md border border-gray-300 focus:outline-none focus:border-blue-500">
                <button id="filterBtn"
                    class="ml-2 bg-blue-500 text-white px-4 py-2 rounded-md hover:bg-blue-600 focus:outline-none focus:ring-2 focus:ring-blue-300">
                    Filtrar
                </button>
            </div>
            

        </div>

        <div>
            <div class="flex justify-center items-center mt-4">
                <table class="max-w-full divide-y divide-gray-200">
                    <thead class="text-xs text-gray-700 uppercase bg-gray-50 dark:bg-gray-700 dark:text-gray-400">
                        <tr>
                            <th scope="col" class="px-6 py-3">
                                CPF
                            </th>
                            <th scope="col" class="px-6 py-3">
                                Nome Completo
                            </th>
                            <th scope="col" class="px-6 py-3">
                                Empresa
                            </th>
                            <th scope="col" class="px-6 py-3">
                                Funções
                            </th>
                            <th scope="col" class="px-6 py-3">
                                Ações
                            </th>
                        </tr>
                    </thead>
                    <tbody class="bg-white divide-y divide-gray-200">
                        {% if clientes %}
                        {% for cliente in clientes %}
                        <tr
                            class="{{ 'bg-white' if loop.index is even else 'bg-gray-50' }} border dark:bg-gray-900 dark:border-gray-700">
                            <td
                                class="px-6 py-4 font-medium text-gray-900 whitespace-nowrap dark:text-white text-center">
                                <a href="{{ url_for('main_routes.permissao_individual', cpf=cliente['cpf']) }}"
                                    class="text-blue-500 hover:underline text-center">
                                    {{ cliente['cpf'] }}
                                </a>
                            </td>
                            <td class="px-8 py-4 text-center">{{ cliente['nome_completo'] or 'Sem Nome' }}</td>
                            <td class="px-8 py-4 text-center">{{ cliente['empresa'] or 'Sem Empresa' }}</td>
                            <td class="px-8 py-4 text-center">{{ cliente['funcoes'] or 'Sem Funções' }}</td>
                            <td class="px-10 py-4 text-center flex items-center space-x-2">
                                <form method="post"
                                    action="{{ url_for('main_routes.criacao_login', cpf_cliente=cliente['cpf']) }}">
                                    <!-- Seu formulário aqui -->
                                    <button id="botao-ativar"
                                        class="py-2.5 px-5 mr-2 mb-2 text-sm font-medium text-white focus:outline-none bg-green-500 rounded-full hover:bg-green-600 focus:ring-4 focus:ring-green-300 dark:bg-green-600 dark:hover:bg-green-700 dark:focus:ring-green-900"
                                        type="submit">Ativar</button>
                                </form>

                                <form method="post"
                                    action="{{ url_for('main_routes.bloquear_cliente', cpf=cliente['cpf']) }}"
                                    style="display: inline;">
                                    <button
                                        class="py-2.5 px-5 mr-2 mb-2 text-sm font-medium text-gray-900 focus:outline-none bg-white rounded-full border border-gray-200 {% if cliente['status'] == 'bloqueado' %}cursor-not-allowed opacity-50{% else %}hover:bg-gray-100 hover:text-blue-700{% endif %} focus:z-10 focus:ring-4 focus:ring-gray-200 dark:focus:ring-gray-700 dark:bg-gray-800 dark:text-gray-400 dark:border-gray-600 dark:hover:text-white dark:hover:bg-gray-700"
                                        type="submit" {% if cliente['status']=='bloqueado' %}disabled{% endif %}>
                                        {% if cliente['status'] == 'bloqueado' %}
                                        Bloqueado
                                        {% else %}
                                        Bloquear
                                        {% endif %}
                                    </button>
                                </form>

                                <form method="post"
                                    action="{{ url_for('main_routes.delete_usuario', cpf=cliente['cpf']) }}"
                                    style="display: inline;">
                                    <button
                                        class="text-white bg-red-700 hover:bg-red-800 focus:outline-none focus:ring-4 focus:ring-red-300 font-medium rounded-full text-sm px-5 py-2.5 text-center mr-2 mb-2 dark:bg-red-600 dark:hover:bg-red-700 dark:focus:ring-red-900"
                                        type="submit">Deletar</button>
                                </form>
                            </td>
                        </tr>
                        {% endfor %}
                        {% else %}
                        <tr>
                            <td colspan="5" class="text-center py-4">Sem dados</td>
                        </tr>
                        {% endif %}
                    </tbody>
                </table>

            </div>
        </div>
    </div>

    <script src="{{ url_for('static', filename='js/components/filtro_nome.js') }}"></script>
    <script src="{{ url_for('static', filename='js/components/filtro_cpf.js') }}"></script>
    <script src="../static/js/components/sidebar.js"></script>
    <script src="https://code.jquery.com/jquery-3.6.4.min.js"></script>
</body>

</html>